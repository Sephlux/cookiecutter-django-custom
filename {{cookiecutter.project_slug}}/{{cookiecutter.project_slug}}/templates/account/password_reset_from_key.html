<!-- templates/account/password_reset_from_key.html -->
{% raw %}{% extends "account/base_auth.html" %}
{% load i18n %}

{% block title %}{% trans "Choose a new password" %}{% endblock %}

{% block content %}
  <fieldset
    class="fieldset bg-base-200 border-base-300 rounded-box w-xs sm:w-sm md:w-md border p-4 shadow-xl backdrop-blur">
    <div class="flex flex-col items-center mt-4 mb-6">
      <h1 class="text-2xl font-semibold">{% trans "Set a new password" %}</h1>
      <p class="mt-1 text-sm opacity-70">{% trans "Please enter your new password twice." %}</p>
    </div>

    {% if token_fail %}
      <div class="alert alert-error mb-4">
        <span>{% trans "The reset link is invalid or has expired." %}</span>
      </div>
      <a class="btn btn-primary w-full" href="{% url 'account_reset_password' %}">
        {% trans "Request a new reset link" %}
      </a>
    {% else %}
      <form method="post" action="{{ action_url }}" class="w-full space-y-2" novalidate>
        {% csrf_token %}
        {% if form.non_field_errors %}
          <div class="alert alert-error mb-2">
            <span>{{ form.non_field_errors|join:", " }}</span>
          </div>
        {% endif %}

        <fieldset class="fieldset" id="password1-field">
          <label class="label" for="id_password1">
            <span class="label-text">{% trans "New password" %}</span>
          </label>
          <input
            id="id_password1"
            type="password"
            name="password1"
            autocomplete="new-password"
            required
            class="input w-full"
          />
          {% if form.password1.errors %}
            <p class="label break-words whitespace-normal">
              <span class="label-text-alt text-error">{{ form.password1.errors|join:"<br>" }}</span>
            </p>
          {% endif %}
        </fieldset>

        <fieldset class="fieldset" id="password2-field">
          <label class="label" for="id_password2">
            <span class="label-text">{% trans "Confirm new password" %}</span>
          </label>
          <input
            id="id_password2"
            type="password"
            name="password2"
            autocomplete="new-password"
            required
            class="input w-full"
          />
          {% if form.password2.errors %}
            <p class="label break-words whitespace-normal">
              <span class="label-text-alt text-error">{{ form.password2.errors|join:"<br>" }}</span>
            </p>
          {% endif %}
        </fieldset>

        <button type="submit" class="btn btn-primary w-full mt-4">
          {% trans "Change password" %}
        </button>
      </form>
    {% endif %}
  </fieldset>
{% endblock %}{% endraw %}
